public class GitHubUploader {
    public static void uploadFile(String content, String filename) {
        String token = 'ghp_SfT0n22IQAnbMP3w...'; // Your GitHub token
        String repo = 'Salesforce-Knowledge-Hub';
        String owner = 'lavanyamane66';
        String path = 'reports/' + filename;

        Http http = new Http();
        HttpRequest getReq = new HttpRequest();
        getReq.setEndpoint('https://api.github.com/repos/' + owner + '/' + repo + '/contents/' + path);
        getReq.setHeader('Authorization', 'Bearer ' + token);
        getReq.setMethod('GET');

        HttpResponse getRes = http.send(getReq);
        String sha = null;

        // If file exists, extract SHA
        if (getRes.getStatusCode() == 200) {
            Map<String, Object> responseMap = (Map<String, Object>) JSON.deserializeUntyped(getRes.getBody());
            sha = (String) responseMap.get('sha');
        }

        // Prepare file content for upload
        HttpRequest req = new HttpRequest();
        req.setEndpoint('https://api.github.com/repos/' + owner + '/' + repo + '/contents/' + path);
        req.setHeader('Authorization', 'Bearer ' + token);
        req.setHeader('Content-Type', 'application/json');
        req.setMethod('PUT');

        Map<String, Object> body = new Map<String, Object>();
        body.put('message', 'Upload ' + filename + ' from Salesforce');
        body.put('content', EncodingUtil.base64Encode(Blob.valueOf(content)));
        if (sha != null) {
            body.put('sha', sha); // Include SHA for updates
        }

        req.setBody(JSON.serialize(body));

        HttpResponse res = http.send(req);
        System.debug('GitHub Response: ' + res.getBody());
    }
}

  
    }
}

